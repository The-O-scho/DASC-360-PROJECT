final[c(9,33,51,56,57,60,62,74,75), ]
final[c(9,33,51,56,57,60,62,74,75), ]
colMeans(numeric_final)
comparison = data.frame(
Row = c(9,33,51,56,57,60,62,74,75, "Mean"),
t(rbind(final[c(9,33,51,56,57,60,62,74,75), ],
colMeans(numeric_final)))
)
comparison
comparison
# Create a comparison dataframe
comparison = final[c(9,33,51,56,57,60,62,74,75), ]
comparison = rbind(comparison, colMeans(numeric_final))
rownames(comparison)[nrow(comparison)] <- "Mean"
comparison
final[c(9,33,51,56,57,60,62,74,75), ]
colMeans(numeric_final)
# Create a comparison dataframe
comparison = final[c(9,33,51,56,57,60,62,74,75), ]
comparison = rbind(comparison, colMeans(numeric_final))
comparison
# Create a comparison dataframe
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
comparison
# Create a comparison dataframe
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
rownames(comparison)[nrow(comparison)] <- "Mean"
comparison
# Create a comparison dataframe
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
comparison
# Create a comparison dataframe
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
comparison
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
rownames(comparison)[nrow(comparison)] = "Mean"
comparison
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
comparison
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
rownames(comparison)[nrow(comparison)] = "Mean"
comparison
rename(rownames(comparison)[nrow(comparison)] = "Mean")
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
rownames(comparison)[nrow(comparison)] = "Mean"
comparison
# Create a comparison dataframe
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
rownames(comparison)[10] = "Mean"
comparison
rownames(comparison)[10] = "Mean"
# Create a comparison dataframe
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ], colMeans(numeric_final))
comparison = as.data.frame(comparison)
rownames(comparison)[10] = "Mean"
comparison
final[c(9,33,51,56,57,60,62,74,75), ]
colMeans(numeric_final)
# bounds
mean_vals = colMeans(numeric_final)
sd_vals = apply(numeric_final, 2, sd)
upper_bound = mean_vals + 2 * sd_vals
lower_bound = mean_vals - 2 * sd_vals
# Create comparison with bounds
comparison = rbind(numeric_final[c(9,33,51,56,57,60,62,74,75), ],
mean_vals,
upper_bound,
lower_bound)
comparison = as.data.frame(comparison)
rownames(comparison)[10:12] = c("Mean", "Mean+2SD", "Mean-2SD")
comparison
print(comparison)
view(comparison)
print(comparison, n = Inf, width = Inf)
comparison
options(width = 12)
comparison
options(n = 12)
comparison
view(comparison)
comparison
view(comparison)
final[c(9,33,51,56,57,60,62,74,75), ]
cor(numeric_final)
cor(numeric_final[-outliers, ])
#display next to each other
cat("With outliers:\n")
print(cor(numeric_final))
cat("\n\nWithout outliers:\n")
print(cor(numeric_final[-outliers, ]))
#display next to each other
cat("With outliers:\n")
print(cor(numeric_final))
getwd
getwd()
cor_outlier = cor(numeric_final)
cor_without = cor(numeric_final[-outliers, ])
cor_difference = cor_without - cor_with
cor_outlier = cor(numeric_final)
cor_without = cor(numeric_final[-outliers, ])
cor_difference = cor_outlier - cor_without
cor_difference
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(jsonlite)
library(readxl)
library(psych)
library(ggplot2)
library(corrplot)
df_1 = read.csv("https://ourworldindata.org/grapher/expected-years-of-schooling.csv?v=1&csvType=filtered&useColumnShortNames=true&mapSelect=CHN~NOR~SWE~FIN~CAN~USA~RUS~DEU~NLD~DNK~IRL~ISL~GBR~ESP~FRA~ITA~MEX~IND~BFA~MLI~DZA~TCD~ZAF~RWA~COD~PRY~BRA~PER~COL~AUS~NZL~PNG~PAK&overlay=download-data")
df_2 = read.csv("https://ourworldindata.org/grapher/average-years-of-schooling.csv?v=1&csvType=filtered&useColumnShortNames=true&mapSelect=CAN~USA~MEX~RUS~CHN~GBR~IRL~ISL~AND~ESP~FRA~DEU~DNK~NLD~ITA~BFA~RWA~COD~ZAF~SOM~TCD~DZA~MLI~AUS~PNG~NZL~BRA~PER~COL~NOR~FIN~SWE&overlay=download-data")
df_3 = read.csv("https://ourworldindata.org/grapher/total-government-expenditure-on-education-gdp.csv?v=1&csvType=filtered&useColumnShortNames=true&mapSelect=CAN~USA&overlay=download-data")
df_4 = read.csv("https://ourworldindata.org/grapher/schools-access-drinking-water.csv?v=1&csvType=full&useColumnShortNames=true")
df_5 = read.csv("https://ourworldindata.org/grapher/human-rights-index-vdem.csv?v=1&csvType=full&useColumnShortNames=true")
df_5 = df_5 %>%
group_by(Entity) %>%
mutate(mean_human_rights = mean(civ_libs_vdem__estimate_best, na.rm = TRUE))
df_6 = read.csv("world_population.csv")
df_6 = df_6 %>%
rename(Entity = Country.Territory)
df_6 = df_6[,c("Entity", "Density..per.km.." )]
df_7 = read_excel("publications.xlsx")
df_7 = df_7 %>%
rename(Entity = Country)
df_7 = df_7[,c("Entity","Citations per document")]
#load up on economic data to predict mys
#gini index wealth disparity
df_8 = merge(df_1,df_2,all = TRUE)
df_9 = merge(df_3,df_4,all = TRUE)
df_10 = merge(df_5,df_6,all = TRUE)
df_11 = merge(df_7, df_8, all = TRUE)
df_12 = merge(df_9, df_10, all = TRUE)
df_13 = merge(df_11, df_12, all = TRUE)
final = df_13 %>%
group_by(Entity) %>%
summarise(across(everything(), ~ first(na.omit(.)))) %>%
drop_na() %>%
dplyr::select(-Code, -Year, -time.1, -time, -owid_region, -civ_libs_vdem__estimate_best)
final = final %>%
rename(expected_schooling = eys__sex_total, mean_schooling = mys__sex_total, GDP_share = combined_expenditure_share_gdp, primary_water = X_4_a_1__se_acs_h2o__primary, upper_secondary_water = X_4_a_1__se_acs_h2o__upper_secondary, lower_secondary_water = X_4_a_1__se_acs_h2o__lower_secondary, mean_rights = mean_human_rights, density_per_km = Density..per.km..)
final
# Visualize and use describe() to present descriptive statistics for each dimension
# Visualize and summarize the covariability between each pair of dimensions
# Identify potential two-dimensional outliers and investigate their influence
final
eigen(final[,c(3,5,9)])
as.matrix(final[,c(3,5,9)])
eigen(final_matrix_response)
final_matrix_response = as.matrix(final[,c(3,5,9)])
eigen(final_matrix_response)
R = cor(final_matrix_response)
eigen(R)
final_matrix_predictor = as.matrix(final[,-c(3,5,9)])
final_matrix_predictor
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(3,5,9)])
R_predictor = cor(final_matrix_predictor)
final_matrix_predictor = as.matrix(final[,-c(3,5,9)])
R_predictor = cor(final_matrix_predictor)
R_response
final_matrix_predictor = as.matrix(final[,c(1,2,4,6,7,8,10)])
R_predictor = cor(final_matrix_predictor)
final_matrix_predictor = as.matrix(final[,-c(3,5,9)])
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
R_response
eigen_response = eigen(R_response)
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(3,5,9)])
R_predictor = cor(final_matrix_predictor)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
eigen_response
eigen_predictor
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
eigen_response
eigen_predictor
#change Entity to be a row name
final = final %>%
dplyr::select(-Entity)
final
final_matrix_response = as.matrix(final[,c(3,5,9)])
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
eigen_response
eigen_predictor
plot(eigen$values)
plot(eigen_response$values)
plot(eigen_response$values, type = "b")
plot(eigen_predictor$values, type = "b")
eigen_predictor
which(eigen_response$values > 1)
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
eigen_response
eigen_predictor
plot(eigen_response$values, type = "b")
plot(eigen_predictor$values, type = "b")
which(eigen_response$values > 1)
which(eigen_predictor$values > 1)
which(eigen_response$values > 0.7)
which(eigen_predictor$values > 0.7)
plot(eigen_response$values, type = "b")
#No elbow exists
plot(eigen_predictor$values, type = "b")
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
plot(eigen_response$values, type = "b")
#No elbow exists
plot(eigen_predictor$values, type = "b")
#1
which(eigen_response$values > 1)
#1
which(eigen_predictor$values > 1)
#1
which(eigen_response$values > 0.7)
#2
which(eigen_predictor$values > 0.7)
#3
corrplot(R_response, method="color",order = "hclust")
corrplot(R_predictor, method="color",order = "hclust")
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
plot(eigen_response$values, type = "b")
#No elbow exists
plot(eigen_predictor$values, type = "b")
#1
which(eigen_response$values > 1)
#1
which(eigen_predictor$values > 1)
#1
which(eigen_response$values > 0.7)
#2
which(eigen_predictor$values > 0.7)
#3
corrplot(R_response, method="color",order = "hclust")
corrplot(R_predictor, method="color",order = "hclust")
corrplot(cor(as.matrix(final[,-1])), method="color",order = "hclust")
corrplot(R_response, method="color",order = "hclust")
corrplot(R_predictor, method="color",order = "hclust")
plot(eigen_response$values, type = "b")
#1
which(eigen_predictor$values > 1)
#No elbow exists
plot(eigen_predictor$values, type = "b")
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
plot(eigen_response$values, type = "b")
#No elbow exists
plot(eigen_predictor$values, type = "b")
#1
which(eigen_response$values > 1)
#1
which(eigen_predictor$values > 1)
#1
which(eigen_response$values > 0.7)
#2
which(eigen_predictor$values > 0.7)
#3
corrplot(R_response, method="color",order = "hclust")
corrplot(R_predictor, method="color",order = "hclust")
plot(eigen_response$values, type = "b")
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
plot(eigen_response$values, type = "b")
#No elbow exists
plot(eigen_predictor$values, type = "b")
#1
which(eigen_response$values > 1)
#1
which(eigen_predictor$values > 1)
#1
which(eigen_response$values > 0.7)
#2
which(eigen_predictor$values > 0.7)
#3
corrplot(R_response, method="color",order = "hclust")
corrplot(R_predictor, method="color",order = "hclust")
#Used jolifee write description later
eigen_response
eigen_predictor
Response_Rotated_orthogonal = pca(r = R_response, nfactors = 1, rotate = "varimax")$loadings[]
Response_Rotated_orthogonal_1 = pca(r = R_response, nfactors = 1, rotate = "varimax")$loadings[]
Response_Rotated_orthogonal_2 = pca(r = R_response, nfactors = 2, rotate = "varimax")$loadings[]
Response_Rotated_orthogonal_1
Response_Rotated_orthogonal_2
Response_Rotated_oblique_1 = pca(r = R_response, nfactors = 1, rotate = "oblimin")$loadings[]
Response_Rotated_oblique_2 = pca(r = R_response, nfactors = 2, rotate = "oblimin")$loadings[]
Response_Rotated_orthogonal_1 = pca(r = R_response, nfactors = 1, rotate = "varimax")$loadings[]
Response_Rotated_orthogonal_2 = pca(r = R_response, nfactors = 2, rotate = "varimax")$loadings[]
Response_Rotated_oblique_1 = pca(r = R_response, nfactors = 1, rotate = "oblimin")$loadings[]
Response_Rotated_oblique_2 = pca(r = R_response, nfactors = 2, rotate = "oblimin")$loadings[]
Response_Rotated_oblique_1
Response_Rotated_oblique_1
Response_Rotated_oblique_2
Var = colSums(Response_Rotated_orthogonal_1^2/nrow(Response_Rotated_orthogonal_1))
Var
Var_2 = colSums(Response_Rotated_orthogonal_2^2/nrow(Response_Rotated_orthogonal_2))
Var_2
Var_2[1]+Var_2[2]
numeric_final = final[,-c(1)]
describe(final)
#Group by Entity/ Country and find all plots
ggplot(data = final, aes(x = Entity, y = `Citations per document`)) +
geom_point()
library(tidyverse)
library(dplyr)
library(jsonlite)
library(readxl)
library(psych)
library(ggplot2)
library(corrplot)
df_1 = read.csv("https://ourworldindata.org/grapher/expected-years-of-schooling.csv?v=1&csvType=filtered&useColumnShortNames=true&mapSelect=CHN~NOR~SWE~FIN~CAN~USA~RUS~DEU~NLD~DNK~IRL~ISL~GBR~ESP~FRA~ITA~MEX~IND~BFA~MLI~DZA~TCD~ZAF~RWA~COD~PRY~BRA~PER~COL~AUS~NZL~PNG~PAK&overlay=download-data")
df_2 = read.csv("https://ourworldindata.org/grapher/average-years-of-schooling.csv?v=1&csvType=filtered&useColumnShortNames=true&mapSelect=CAN~USA~MEX~RUS~CHN~GBR~IRL~ISL~AND~ESP~FRA~DEU~DNK~NLD~ITA~BFA~RWA~COD~ZAF~SOM~TCD~DZA~MLI~AUS~PNG~NZL~BRA~PER~COL~NOR~FIN~SWE&overlay=download-data")
df_3 = read.csv("https://ourworldindata.org/grapher/total-government-expenditure-on-education-gdp.csv?v=1&csvType=filtered&useColumnShortNames=true&mapSelect=CAN~USA&overlay=download-data")
df_4 = read.csv("https://ourworldindata.org/grapher/schools-access-drinking-water.csv?v=1&csvType=full&useColumnShortNames=true")
df_5 = read.csv("https://ourworldindata.org/grapher/human-rights-index-vdem.csv?v=1&csvType=full&useColumnShortNames=true")
df_5 = df_5 %>%
group_by(Entity) %>%
mutate(mean_human_rights = mean(civ_libs_vdem__estimate_best, na.rm = TRUE))
df_6 = read.csv("world_population.csv")
df_6 = df_6 %>%
rename(Entity = Country.Territory)
df_6 = df_6[,c("Entity", "Density..per.km.." )]
df_7 = read_excel("publications.xlsx")
df_7 = df_7 %>%
rename(Entity = Country)
df_7 = df_7[,c("Entity","Citations per document")]
#load up on economic data to predict mys
#gini index wealth disparity
df_8 = merge(df_1,df_2,all = TRUE)
df_9 = merge(df_3,df_4,all = TRUE)
df_10 = merge(df_5,df_6,all = TRUE)
df_11 = merge(df_7, df_8, all = TRUE)
df_12 = merge(df_9, df_10, all = TRUE)
df_13 = merge(df_11, df_12, all = TRUE)
final = df_13 %>%
group_by(Entity) %>%
summarise(across(everything(), ~ first(na.omit(.)))) %>%
drop_na() %>%
dplyr::select(-Code, -Year, -time.1, -time, -owid_region, -civ_libs_vdem__estimate_best)
final = final %>%
rename(expected_schooling = eys__sex_total, mean_schooling = mys__sex_total, GDP_share = combined_expenditure_share_gdp, primary_water = X_4_a_1__se_acs_h2o__primary, upper_secondary_water = X_4_a_1__se_acs_h2o__upper_secondary, lower_secondary_water = X_4_a_1__se_acs_h2o__lower_secondary, mean_rights = mean_human_rights, density_per_km = Density..per.km..)
final
# Visualize and use describe() to present descriptive statistics for each dimension
# Visualize and summarize the covariability between each pair of dimensions
# Identify potential two-dimensional outliers and investigate their influence
Predictor_Rotated_orthogonal_1 = pca(r = R_response, nfactors = 1, rotate = "varimax")$loadings[]
Predictor_Rotated_orthogonal_3 = pca(r = R_response, nfactors = 3, rotate = "varimax")$loadings[]
Predictor_Rotated_oblique_1 = pca(r = R_response, nfactors = 1, rotate = "oblimin")$loadings[]
Predictor_Rotated_oblique_3 = pca(r = R_response, nfactors = 3, rotate = "oblimin")$loadings[]
Var = colSums(Predictor_Rotated_orthogonal_1^2/nrow(Predictor_Rotated_orthogonal_1))
Var_2 = colSums(Predictor_Rotated_orthogonal_3^2/nrow(Predictor_Rotated_orthogonal_3))
Var_2[1]+Var_2[2]
Var
Var
Var_2[1]+Var_2[2]
Predictor_Rotated_orthogonal_1
Predictor_Rotated_orthogonal_3
Predictor_Rotated_oblique_1
Predictor_Rotated_oblique_3
Response_Rotated_orthogonal_1
Response_Rotated_orthogonal_2
Predictor_Rotated_orthogonal_1 = pca(r = R_response, nfactors = 1, rotate = "varimax")$loadings[]
Predictor_Rotated_orthogonal_3 = pca(r = R_response, nfactors = 3, rotate = "varimax")$loadings[]
Predictor_Rotated_oblique_1 = pca(r = R_response, nfactors = 1, rotate = "oblimin")$loadings[]
Predictor_Rotated_oblique_3 = pca(r = R_response, nfactors = 3, rotate = "oblimin")$loadings[]
Predictor_Rotated_oblique_1
Predictor_Rotated_oblique_3
Var = colSums(Predictor_Rotated_orthogonal_1^2/nrow(Predictor_Rotated_orthogonal_1))
Var_2 = colSums(Predictor_Rotated_orthogonal_3^2/nrow(Predictor_Rotated_orthogonal_3))
Var
Var_2[1]+Var_2[2]
Response_Rotated_orthogonal_2
Response_Rotated_oblique_2
summarize(Response_Rotated_oblique_2)
summarise(Response_Rotated_oblique_2)
Var_response_olbiqe = colSums(Response_Rotated_oblique_2^2/nrow(Response_Rotated_oblique_2))
Var_Predictor_olbiqe = colSums(Predictor_Rotated_oblique_3^2/nrow(Predictor_Rotated_oblique_3))
Response_Rotated_oblique_2
Predictor_Rotated_oblique_3
Var_response_olbiqe = colSums(Response_Rotated_oblique_2^2/nrow(Response_Rotated_oblique_2))
Var_Predictor_olbiqe = colSums(Predictor_Rotated_oblique_3^2/nrow(Predictor_Rotated_oblique_3))
Var_response_olbiqe
Var_Predictor_olbiqe
Var_response_olbiqe[1] + Var_response_olbiqe[2]
Var_Predictor_olbiqe[1] + Var_Predictor_olbiqe[2] + Var_Predictor_olbiqe[3]
Var_response_olbiqe
Var_Predictor_olbiqe
R_hat_reponse = Response_Rotated_oblique_2 %*% t(Response_Rotated_oblique_2)
A_resid = R_response - R_hat_reponse
A_resid
R_hat_reponse = Response_Rotated_oblique_2 %*% t(Response_Rotated_oblique_2)
A_resid_response = R_response - R_hat_reponse
A_resid_response
R_hat_predictor = Predictor_Rotated_oblique_3 %*% t(Predictor_Rotated_oblique_3)
A_resid_predictor = R_predictor - R_hat_predictor
#Response
Response_Rotated_orthogonal_1 = pca(r = R_response, nfactors = 1, rotate = "varimax")$loadings[]
Response_Rotated_orthogonal_2 = pca(r = R_response, nfactors = 2, rotate = "varimax")$loadings[]
Response_Rotated_oblique_2
Response_Rotated_oblique_1 = pca(r = R_response, nfactors = 1, rotate = "oblimin")$loadings[]
Response_Rotated_oblique_2 = pca(r = R_response, nfactors = 2, rotate = "oblimin")$loadings[]
Var = colSums(Response_Rotated_orthogonal_1^2/nrow(Response_Rotated_orthogonal_1))
Var_2 = colSums(Response_Rotated_orthogonal_2^2/nrow(Response_Rotated_orthogonal_2))
Var_2[1]+Var_2[2]
#Predictor
Predictor_Rotated_orthogonal_1 = pca(r = R_predictor, nfactors = 1, rotate = "varimax")$loadings[]
Predictor_Rotated_orthogonal_3 = pca(r = R_predictor, nfactors = 3, rotate = "varimax")$loadings[]
Predictor_Rotated_oblique_1 = pca(r = R_predictor, nfactors = 1, rotate = "oblimin")$loadings[]
Predictor_Rotated_oblique_3 = pca(r = R_predictor, nfactors = 3, rotate = "oblimin")$loadings[]
Predictor_Rotated_oblique_3
Var = colSums(Predictor_Rotated_orthogonal_1^2/nrow(Predictor_Rotated_orthogonal_1))
Var_2 = colSums(Predictor_Rotated_orthogonal_3^2/nrow(Predictor_Rotated_orthogonal_3))
Var
Var_2[1]+Var_2[2]
#Use Jolifee, and oblique for both
Predictor_Rotated_orthogonal_3
Predictor_Rotated_oblique_3
Response_Rotated_orthogonal_2
Response_Rotated_oblique_2
Var = colSums(Predictor_Rotated_orthogonal_1^2/nrow(Predictor_Rotated_orthogonal_1))
Var_2 = colSums(Predictor_Rotated_orthogonal_3^2/nrow(Predictor_Rotated_orthogonal_3))
Var
Var_2[1]+Var_2[2]
Var_2
Var_response_orthogonal = colSums(Response_Rotated_orthogonal_2^2/nrow(Response_Rotated_orthogonal_2))
Var_Predictor_orthogonal = colSums(Predictor_Rotated_orthogonal_3^2/nrow(Predictor_Rotated_orthogonal_3))
Var_response_orthogonal
Var_Predictor_orthogonal
R_hat_reponse = Response_Rotated_orthogonal_2 %*% t(Response_Rotated_orthogonal_2)
A_resid_response = R_response - R_hat_reponse
A_resid_response
R_hat_predictor = Predictor_Rotated_orthogonal_3 %*% t(Predictor_Rotated_orthogonal_3)
A_resid_predictor = R_predictor - R_hat_predictor
A_resid_predictor
plot(eigen_response$values, type = "b")
#Response varaibles are expected schooling, mean rights, GDP_share [,3], [,5], [,9]
#predictor varaibles are everything else
final_matrix_response = as.matrix(final[,c(3,5,9)])
R_response = cor(final_matrix_response)
eigen_response = eigen(R_response)
final_matrix_predictor = as.matrix(final[,-c(1,3,5,9)])
R_predictor = cor(final_matrix_predictor)
eigen_predictor = eigen(R_predictor)
plot(eigen_response$values, type = "b")
#No elbow exists
plot(eigen_predictor$values, type = "b")
#1
which(eigen_response$values > 1)
#1
which(eigen_predictor$values > 1)
#1
which(eigen_response$values > 0.7)
#2
which(eigen_predictor$values > 0.7)
#3
corrplot(R_response, method="color",order = "hclust")
corrplot(R_predictor, method="color",order = "hclust")
#Used jolifee write description later
plot(eigen_response$values, type = "b")
